# RAV4 EV BatterySpoof

This project spoofs (pretends to be) the battery management system in a
[first-generation Toyota RAV4 EV](https://en.wikipedia.org/wiki/Toyota_RAV4_EV#First_generation_(1997)).
It runs on an Arduino microcontroller.
The program outputs status information in the same format as the original
battery management system, so that the battery can be replaced with new cells
and the car will accept this.

It's intended to run on an
[Arduino UNO R4 Minima](https://docs.arduino.cc/hardware/uno-r4-minima/), but it
can run on another Arduino board by updating the build commands in the Makefile
to use a different fully-qualified board name (FQBN).
It communicates over serial and RS232 using a shield such as
[the DFRobot RS232 shield](https://www.dfrobot.com/product-1030.html).

## Setup

Install the [Arduino CLI](https://github.com/arduino/arduino-cli?tab=readme-ov-file)
according to [the installation instructions](https://arduino.github.io/arduino-cli/latest/installation/).

In the project directory, run `make init`.

## Development

Development tasks can be accomplished with Make:
- Run `make build` to compile the project.
- Run `make format` to auto-format code.
- Run `make test` to run tests.
- Run `make check` to format code and run tests.
- Run `make clean` to remove artifacts generated by `make build`.

## Build/Install

Connect the Arduino via USB.
Run `make install` to install the project to the connected Arduino.

While the Arduino is connected via USB, run `make monitor` to watch its log
output.

## References

- [Arduino language reference](https://docs.arduino.cc/language-reference/)
- [rav4dash](https://github.com/jerkey/rav4dash)
